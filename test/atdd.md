### JPA 가 테스트 범위에 포함되어야 하는 이유는?


저는 테스트할 시간이 없는 상황에서 딱 하나의 테스트만 작성해야 한다면 앞서 말한 사용자 스토리를 검증하는 인수테스트를 작성해야 할 것 입니다.
그 과정에서 실제로 JPA 를 작성한 부분이 비즈니스 로직에 큰 영향을 끼치고 저희가 제어 해야하는 대상 이기에 더더욱 인수 테스트 JPA 를 작성한 부분까지 신뢰 되어야 한다고 생각합니다. 완벽한 V2 아키텍처가 아닌 코드들은 비즈니스 로직이 인프라 계층에 많이 있기 때문입니다.
Mock 이란 행위를 검증하기 위한 용도 이며 이를 통해서 각각의 행위에 대한 시나리오를 검증할 때 작성할 때 많이 사용합니다. 하지만 실제 행위에 해당하는 동작이 정상적인지는 확인하지 못하는 단점이 있습니다. 따라서 JPA 에 대해서 행위만 검증한다는 것은 비즈니스 로직에 대한 신뢰도가 많이 떨어질 것 입니다.
또한 Mock 은 해당 행위 자체가 실제로 동작하는지 알 수 없는 Email, 소셜 로그인 등은 인수테스트에서 테스트 더블(Mock, Spy)을 하는 것이 적합하다고 생각하지만, JPA 기술을 응용한 저희 코드는 실제 동작여부를 제어 해야하기에 테스트 범위에 포함되어야 한다고 생각합니다.
다 떠나 가장 큰 문제로는 테스트 환경에 대한 불안감인데 고안한 방법은 로컬에서는 직접 DB에 접근 하지 못하게 막고 베스천 서버를 하나 두어서 베스천 서버에서만 접근 하게 하고 기존에 datagrip 은 ssh 터널링을 통해 베스천 서버에 접근하는 방식이면 불안감은 해소할 수 있다고 생각합니다.
실제로 직접 인수테스트를 작성해봐야 더 서로간에 이해가 더 빠르다고 생각합니다. 저희 코드내에 리팩터링 대상을 서로 안전하다고 생각한 서로간의 방식으로 리팩터링 해보면서 느낀점을 이야기하는 시간을 가져도 좋을 것 같습니다!
